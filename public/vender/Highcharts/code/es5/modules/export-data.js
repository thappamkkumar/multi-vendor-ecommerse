/**
 * Highcharts JS v11.3.0 (2024-01-10)
 *
 * Exporting module
 *
 * (c) 2010-2024 Torstein Honsi
 *
 * License: www.highcharts.com/license
 */!function(t){"object"==typeof module&&module.exports?(t.default=t,module.exports=t):"function"==typeof define&&define.amd?define("highcharts/modules/export-data",["highcharts","highcharts/modules/exporting"],function(e){return t(e),t.Highcharts=e,t}):t("undefined"!=typeof Highcharts?Highcharts:void 0)}(function(t){"use strict";var e=t?t._modules:{};function a(t,e,a,o){t.hasOwnProperty(e)||(t[e]=o.apply(null,a),"function"==typeof CustomEvent&&window.dispatchEvent(new CustomEvent("HighchartsModuleLoaded",{detail:{path:e,module:t[e]}})))}a(e,"Extensions/DownloadURL.js",[e["Core/Globals.js"]],function(t){var e=t.isSafari,a=t.win,o=t.win.document,n=a.URL||a.webkitURL||a;function i(t){var e=t.replace(/filename=.*;/,"").match(/data:([^;]*)(;base64)?,([0-9A-Za-z+/]+)/);if(e&&e.length>3&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&a.Blob&&n.createObjectURL){for(var o=a.atob(e[3]),i=new a.ArrayBuffer(o.length),r=new a.Uint8Array(i),s=0;s<r.length;++s)r[s]=o.charCodeAt(s);return n.createObjectURL(new a.Blob([r],{type:e[1]}))}}return{dataURLtoBlob:i,downloadURL:function(t,n){var r=a.navigator,s=o.createElement("a");if("string"!=typeof t&&!(t instanceof String)&&r.msSaveOrOpenBlob){r.msSaveOrOpenBlob(t,n);return}t=""+t;var l=/Edge\/\d+/.test(r.userAgent);if((e&&"string"==typeof t&&0===t.indexOf("data:application/pdf")||l||t.length>2e6)&&!(t=i(t)||""))throw Error("Failed to convert to blob");if(void 0!==s.download)s.href=t,s.download=n,o.body.appendChild(s),s.click(),o.body.removeChild(s);else try{if(!a.open(t,"chart"))throw Error("Failed to open window")}catch(e){a.location.href=t}}}}),a(e,"Extensions/ExportData/ExportDataDefaults.js",[],function(){return{exporting:{csv:{annotations:{itemDelimiter:"; ",join:!1},columnHeaderFormatter:null,dateFormat:"%Y-%m-%d %H:%M:%S",decimalPoint:null,itemDelimiter:null,lineDelimiter:"\n"},showTable:!1,useMultiLevelHeaders:!0,useRowspanHeaders:!0,showExportInProgress:!0},lang:{downloadCSV:"Download CSV",downloadXLS:"Download XLS",exportData:{annotationHeader:"Annotations",categoryHeader:"Category",categoryDatetimeHeader:"DateTime"},viewData:"View data table",hideData:"Hide data table",exportInProgress:"Exporting..."}}}),a(e,"Extensions/ExportData/ExportData.js",[e["Core/Renderer/HTML/AST.js"],e["Core/Defaults.js"],e["Extensions/DownloadURL.js"],e["Extensions/ExportData/ExportDataDefaults.js"],e["Core/Globals.js"],e["Core/Series/SeriesRegistry.js"],e["Core/Utilities.js"]],function(t,e,a,o,n,i,r){var s=this&&this.__spreadArray||function(t,e,a){if(a||2==arguments.length)for(var o,n=0,i=e.length;n<i;n++)!o&&n in e||(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return t.concat(o||Array.prototype.slice.call(e))},l=e.getOptions,c=e.setOptions,d=a.downloadURL,h=n.composed,p=n.doc,u=n.win,f=i.series,m=i.seriesTypes,g=m.arearange,x=m.gantt,v=m.map,b=m.mapbubble,y=m.treemap,w=m.xrange,D=r.addEvent,T=r.defined,E=r.extend,S=r.find,C=r.fireEvent,L=r.isNumber,A=r.pick,R=r.pushUnique;function k(t){var e,a=this,o=!!(null===(e=this.options.exporting)||void 0===e?void 0:e.showExportInProgress),n=u.requestAnimationFrame||setTimeout;n(function(){o&&a.showLoading(a.options.lang.exportInProgress),n(function(){try{t.call(a)}finally{o&&a.hideLoading()}})})}function O(){var t=this;k.call(this,function(){var e=t.getCSV(!0);d(M(e,"text/csv")||"data:text/csv,\uFEFF"+encodeURIComponent(e),t.getFilename()+".csv")})}function H(){var t=this;k.call(this,function(){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>Ark1</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style>td{border:none;font-family: Calibri, sans-serif;} .number{mso-number-format:"0.00";} .text{ mso-number-format:"@";}</style><meta name=ProgId content=Excel.Sheet><meta charset=UTF-8></head><body>'+t.getTable(!0)+"</body></html>";d(M(e,"application/vnd.ms-excel")||"data:application/vnd.ms-excel;base64,"+u.btoa(unescape(encodeURIComponent(e))),t.getFilename()+".xls")})}function N(t){var e="",a=this.getDataRows(),o=this.options.exporting.csv,n=A(o.decimalPoint,","!==o.itemDelimiter&&t?1.1.toLocaleString()[1]:"."),i=A(o.itemDelimiter,","===n?";":","),r=o.lineDelimiter;return a.forEach(function(t,o){for(var s="",l=t.length;l--;)"string"==typeof(s=t[l])&&(s='"'.concat(s,'"')),"number"==typeof s&&"."!==n&&(s=s.toString().replace(".",n)),t[l]=s;t.length=a.length?a[0].length:0,e+=t.join(i),o<a.length-1&&(e+=r)}),e}function U(t){var e,a,o,n,i,r,l,c=this.hasParallelCoordinates,d=this.time,h=this.options.exporting&&this.options.exporting.csv||{},p=this.xAxis,u={},m=[],g=[],x=[],v=this.options.lang.exportData,b=v.categoryHeader,y=v.categoryDatetimeHeader,w=function(e,a,o){if(h.columnHeaderFormatter){var n=h.columnHeaderFormatter(e,a,o);if(!1!==n)return n}return e?e instanceof f?t?{columnTitle:o>1?a:e.name,topLevelColumnTitle:e.name}:e.name+(o>1?" ("+a+")":""):e.options.title&&e.options.title.text||(e.dateTime?y:b):b},D=function(t,e,a){var o={},n={};return e.forEach(function(e){var i=(t.keyToAxis&&t.keyToAxis[e]||e)+"Axis",r=L(a)?t.chart[i][a]:t[i];o[e]=r&&r.categories||[],n[e]=r&&r.dateTime}),{categoryMap:o,dateTimeValueAxisMap:n}},E=function(t,e){var a=t.pointArrayMap||["y"];return t.data.some(function(t){return void 0!==t.y&&t.name})&&e&&!e.categories&&"name"!==t.exportKey?s(["x"],a,!0):a},R=[],k=0;for(r in this.series.forEach(function(e){var a,o,n=e.options.keys,r=e.xAxis,s=n||E(e,r),l=s.length,f=!e.requireSorting&&{},m=p.indexOf(r),v=D(e,s);if(!1!==e.options.includeInDataExport&&!e.options.isInternal&&!1!==e.visible){for(S(R,function(t){return t[0]===m})||R.push([m,k]),o=0;o<l;)i=w(e,s[o],s.length),x.push(i.columnTitle||i),t&&g.push(i.topLevelColumnTitle||i),o++;(a={chart:e.chart,autoIncrement:e.autoIncrement,options:e.options,pointArrayMap:e.pointArrayMap,index:e.index}).index,e.options.data.forEach(function(t,n){var i,p,g,x,b={series:a};c&&(v=D(e,s,n)),e.pointClass.prototype.applyOptions.apply(b,[t]);var y=e.data[n]&&e.data[n].name;if(p=(null!==(i=b.x)&&void 0!==i?i:"")+","+y,o=0,(!r||"name"===e.exportKey||!c&&r&&r.hasNames&&y)&&(p=y),f&&(f[p]&&(p+="|"+n),f[p]=!0),u[p]){var w="".concat(p,",").concat(u[p].pointers[e.index]),T=p;u[p].pointers[e.index]&&(u[w]||(u[w]=[],u[w].xValues=[],u[w].pointers=[]),p=w),u[T].pointers[e.index]+=1}else{u[p]=[],u[p].xValues=[];for(var E=[],S=0;S<e.chart.series.length;S++)E[S]=0;u[p].pointers=E,u[p].pointers[e.index]=1}for(u[p].x=b.x,u[p].name=y,u[p].xValues[m]=b.x;o<l;)x=b[g=s[o]],u[p][k+o]=A(v.categoryMap[g][x],v.dateTimeValueAxisMap[g]?d.dateFormat(h.dateFormat,x):null,x),o++}),k+=o}}),u)Object.hasOwnProperty.call(u,r)&&m.push(u[r]);for(n=t?[g,x]:[x],k=R.length;k--;)e=R[k][0],a=R[k][1],o=p[e],m.sort(function(t,a){return t.xValues[e]-a.xValues[e]}),l=w(o),n[0].splice(a,0,l),t&&n[1]&&n[1].splice(a,0,l),m.forEach(function(t){var e=t.name;o&&!T(e)&&(o.dateTime?(t.x instanceof Date&&(t.x=t.x.getTime()),e=d.dateFormat(h.dateFormat,t.x)):e=o.categories?A(o.names[t.x],o.categories[t.x],t.x):t.x),t.splice(a,0,e)});return C(this,"exportData",{dataRows:n=n.concat(m)}),n}function j(t){var e=function(t){if(!t.tagName||"#text"===t.tagName)return t.textContent||"";var a=t.attributes,o="<".concat(t.tagName);return a&&Object.keys(a).forEach(function(t){var e=a[t];o+=" ".concat(t,'="').concat(e,'"')}),o+=">"+(t.textContent||""),(t.children||[]).forEach(function(t){o+=e(t)}),o+="</".concat(t.tagName,">")};return e(this.getTableAST(t))}function V(t){var e=0,a=[],o=this.options,n=t?1.1.toLocaleString()[1]:".",i=A(o.exporting.useMultiLevelHeaders,!0),r=this.getDataRows(i),s=i?r.shift():null,l=r.shift(),c=function(t,e){var a=t.length;if(e.length!==a)return!1;for(;a--;)if(t[a]!==e[a])return!1;return!0},d=function(t,e,a,o){var i=A(o,""),r="highcharts-text"+(e?" "+e:"");return"number"==typeof i?(i=i.toString(),","===n&&(i=i.replace(".",n)),r="highcharts-number"):o||(r="highcharts-empty"),{tagName:t,attributes:a=E({class:r},a),textContent:i}};!1!==o.exporting.tableCaption&&a.push({tagName:"caption",attributes:{class:"highcharts-table-caption"},textContent:A(o.exporting.tableCaption,o.title.text?o.title.text:"Chart")});for(var h=0,p=r.length;h<p;++h)r[h].length>e&&(e=r[h].length);a.push(function(t,e,a){var n,r,s=[],l=0,h=a||e&&e.length,p=0;if(i&&t&&e&&!c(t,e)){for(var u=[];l<h;++l)if((n=t[l])===t[l+1])++p;else if(p)u.push(d("th","highcharts-table-topheading",{scope:"col",colspan:p+1},n)),p=0;else{n===e[l]?o.exporting.useRowspanHeaders?(r=2,delete e[l]):(r=1,e[l]=""):r=1;var f=d("th","highcharts-table-topheading",{scope:"col"},n);r>1&&f.attributes&&(f.attributes.valign="top",f.attributes.rowspan=r),u.push(f)}s.push({tagName:"tr",children:u})}if(e){var u=[];for(l=0,h=e.length;l<h;++l)void 0!==e[l]&&u.push(d("th",null,{scope:"col"},e[l]));s.push({tagName:"tr",children:u})}return{tagName:"thead",children:s}}(s,l,Math.max(e,l.length)));var u=[];r.forEach(function(t){for(var a=[],o=0;o<e;o++)a.push(d(o?"td":"th",null,o?{}:{scope:"row"},t[o]));u.push({tagName:"tr",children:a})}),a.push({tagName:"tbody",children:u});var f={tree:{tagName:"table",id:"highcharts-data-table-".concat(this.index),children:a}};return C(this,"aftergetTableAST",f),f.tree}function B(){this.toggleDataTable(!1)}function F(e){var a=(e=A(e,!this.isDataTableVisible))&&!this.dataTableDiv;if(a&&(this.dataTableDiv=p.createElement("div"),this.dataTableDiv.className="highcharts-data-table",this.renderTo.parentNode.insertBefore(this.dataTableDiv,this.renderTo.nextSibling)),this.dataTableDiv){var o=this.dataTableDiv.style,n=o.display;o.display=e?"block":"none",e?(this.dataTableDiv.innerHTML=t.emptyHTML,new t([this.getTableAST()]).addToDOM(this.dataTableDiv),C(this,"afterViewData",{element:this.dataTableDiv,wasHidden:a||n!==o.display})):C(this,"afterHideData")}this.isDataTableVisible=e;var i=this.exportDivElements,r=this.options.exporting,s=r&&r.buttons&&r.buttons.contextButton.menuItems,l=this.options.lang;if(r&&r.menuItemDefinitions&&l&&l.viewData&&l.hideData&&s&&i){var c=i[s.indexOf("viewData")];c&&t.setElementHTML(c,this.isDataTableVisible?l.hideData:l.viewData)}}function I(){this.toggleDataTable(!0)}function M(t,e){var a=u.navigator,o=u.URL||u.webkitURL||u;try{if(a.msSaveOrOpenBlob&&u.MSBlobBuilder){var n=new u.MSBlobBuilder;return n.append(t),n.getBlob("image/svg+xml")}return o.createObjectURL(new u.Blob(["\uFEFF"+t],{type:e}))}catch(t){}}function P(){var t=this,e=t.dataTableDiv,a=function(t,e){return t.children[e].textContent};if(e&&t.options.exporting&&t.options.exporting.allowTableSorting){var o=e.querySelector("thead tr");o&&o.childNodes.forEach(function(o){var n=o.closest("table");o.addEventListener("click",function(){var i,r,l=s([],e.querySelectorAll("tr:not(thead tr)"),!0),c=s([],o.parentNode.children,!0);l.sort((i=c.indexOf(o),r=t.ascendingOrderInTable=!t.ascendingOrderInTable,function(t,e){var o,n;return o=a(r?t:e,i),n=a(r?e:t,i),""===o||""===n||isNaN(o)||isNaN(n)?o.toString().localeCompare(n):o-n})).forEach(function(t){n.appendChild(t)}),c.forEach(function(t){["highcharts-sort-ascending","highcharts-sort-descending"].forEach(function(e){t.classList.contains(e)&&t.classList.remove(e)})}),o.classList.add(t.ascendingOrderInTable?"highcharts-sort-ascending":"highcharts-sort-descending")})})}}function K(){this.options&&this.options.exporting&&this.options.exporting.showTable&&!this.options.chart.forExport&&this.viewData()}return{compose:function t(e){if(R(h,t)){var a=e.prototype,n=l().exporting;D(e,"afterViewData",P),D(e,"render",K),a.downloadCSV=O,a.downloadXLS=H,a.getCSV=N,a.getDataRows=U,a.getTable=j,a.getTableAST=V,a.hideData=B,a.toggleDataTable=F,a.viewData=I,n&&(E(n.menuItemDefinitions,{downloadCSV:{textKey:"downloadCSV",onclick:function(){this.downloadCSV()}},downloadXLS:{textKey:"downloadXLS",onclick:function(){this.downloadXLS()}},viewData:{textKey:"viewData",onclick:function(){k.call(this,this.toggleDataTable)}}}),n.buttons&&n.buttons.contextButton.menuItems&&n.buttons.contextButton.menuItems.push("separator","downloadCSV","downloadXLS","viewData")),c(o),g&&(g.prototype.keyToAxis={low:"y",high:"y"}),x&&(x.prototype.exportKey="name",x.prototype.keyToAxis={start:"x",end:"x"}),w&&(w.prototype.keyToAxis={x2:"x"}),v&&(v.prototype.exportKey="name"),b&&(b.prototype.exportKey="name"),y&&(y.prototype.exportKey="name")}}}}),a(e,"masters/modules/export-data.src.js",[e["Core/Globals.js"],e["Extensions/DownloadURL.js"],e["Extensions/ExportData/ExportData.js"]],function(t,e,a){t.dataURLtoBlob=e.dataURLtoBlob,t.downloadURL=e.downloadURL,a.compose(t.Chart)})});